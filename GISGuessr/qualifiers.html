<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GISGuessr</title>
  <link rel="preload" href="gen3/IMG_1259.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1258.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1486.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1487.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1469.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1468.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1457.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1456.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7973.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7972.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1225.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1474.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1475.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1239.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1238.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1244.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1233.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1232.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7964.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1473.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1249.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1248.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_8025.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7957.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7956.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7969.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7968.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7914.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7915.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1479.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1478.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1234.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7963.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7962.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1446.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7909.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1464.HEIC.jpg" as="image">
  <link rel="preload" href="output/FifthLCenter.heic.jpg" as="image">
  <link rel="preload" href="output/FifthFCenter.heic.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1465.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1481.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1480.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1229.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1228.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1260.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1254.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1255.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1450.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1451.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7974.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7975.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7959.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7958.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1247.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7910.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7911.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1230.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1231.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7967.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1477.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1476.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7953.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1449.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1448.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1492.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1493.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1250.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1251.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1454.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1455.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7970.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7971.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1227.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1226.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1485.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1484.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1257.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1256.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1453.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1452.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1488.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1489.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1467.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1466.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1482.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1483.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1458.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1240.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1241.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1237.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1236.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7960.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7961.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1445.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1470.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1471.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7954.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7955.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_8026.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_1491.HEIC.jpg" as="image">
  <link rel="preload" href="gen3/IMG_7976.HEIC.jpg" as="image">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
    }

    #game-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    #background-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    #hider, #location-image {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    #controls {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.8);
      padding: 10px;
      border-radius: 10px;
      z-index: 3;
    }

    #map-container {
      position: absolute;
      bottom: 10px;
      right: 10px;
      width: 400px;
      height: 300px;
      background-color: #fff;
      border: 2px solid #ccc;
      border-radius: 10px;
      overflow: hidden;
      z-index: 2;
    }

    #floorplan-image {
      width: 100%;
      height: 100%;
      object-fit: contain;
      position: absolute;
      top: 0;
      left: 0;
    }

    #pin {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: red;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      display: none;
    }

    #guess-button {
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3;
      padding: 5px 10px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #guess-button:disabled {
      background-color: #85bbf4;
    }

    #score-display, #timer-display {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 10px;
      border-radius: 10px;
      z-index: 3;
      font-size: 16px;
    }
    #timer-display {
      top: 100px !important;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div id="background-container">
      <img id="hider" src="question.png" alt="Blink" />
      <img id="location-image" src="question.png" alt="Location View" />
    </div>

    <div id="controls">
      <h3>GISGuessr v1.1.2 (Qualifying)</h3>
      <h4>Made by Ian Park</h4>
      <label for="floor-select">Select Floor:</label>
      <select id="floor-select" onchange="updateFloor();">
        <option>ArtsG.jpg</option>
        <option>Arts1.jpg</option>
        <option>Arts2.jpg</option>
        <option>Arts3.jpg</option>
        <option>Arts4.jpg</option>
        <option>Arts5.jpg</option>
        <option>Arts6.jpg</option>
        <option>CentralG.jpg</option>
        <option>Central1.jpg</option>
        <option>Central2.jpg</option>
        <option>SecondaryB.jpg</option>
        <option>SecondaryL.jpg</option>
        <option>SecondaryG.jpg</option>
        <option>SecondaryF.jpg</option>
        <option>SecondaryS.jpg</option>
      </select>
      <div>
        <input type="number" id="timer-input" min="10" max="300" value="60" hidden/>
        <input type="number" id="rounds" value="20" hidden />
        <input type="number" id="blink" value="0" hidden/><br>
        <button id="start-game">Start Game</button>
      </div>
    </div>

    <div id="map-container">
      <img id="floorplan-image" src="question.png" alt="Floor Plan" />
      <div id="pin"></div>
      <button id="guess-button">GUESS</button>
    </div>

    <div id="score-display"></div>
    <div id="timer-display"></div>
  </div>

  <script>
    const locations = [
    {
        "image": "gen3/IMG_1259.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 20,
            "y": 75,
            "w": 22,
            "h": 48
        }
    },
    {
        "image": "gen3/IMG_1258.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 22,
            "y": 77,
            "w": 20,
            "h": 122
        }
    },
    {
        "image": "gen3/IMG_1486.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 198,
            "y": 33,
            "w": 56,
            "h": 94
        }
    },
    {
        "image": "gen3/IMG_1487.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 149,
            "y": 33,
            "w": 50,
            "h": 92
        }
    },
    {
        "image": "gen3/IMG_1469.HEIC.jpg",
        "correctFloor": "Arts2.jpg",
        "rect": {
            "x": 235,
            "y": 66,
            "w": 74,
            "h": 202
        }
    },
    {
        "image": "gen3/IMG_1468.HEIC.jpg",
        "correctFloor": "ArtsG.jpg",
        "rect": {
            "x": 313,
            "y": 166,
            "w": 56,
            "h": 77
        }
    },
    {
        "image": "gen3/IMG_1457.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 149,
            "y": 106,
            "w": 90,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_1456.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 122,
            "y": 72,
            "w": 47,
            "h": 126
        }
    },
    {
        "image": "gen3/IMG_7973.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 144,
            "y": 159,
            "w": 148,
            "h": 16
        }
    },
    {
        "image": "gen3/IMG_7972.HEIC.jpg",
        "correctFloor": "Central1.jpg",
        "rect": {
            "x": 225,
            "y": 84,
            "w": 126,
            "h": 67
        }
    },
    {
        "image": "gen3/IMG_1225.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 323,
            "y": 107,
            "w": 17,
            "h": 91
        }
    },
    {
        "image": "gen3/IMG_1474.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 131,
            "y": 177,
            "w": 142,
            "h": 19
        }
    },
    {
        "image": "gen3/IMG_1475.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 130,
            "y": 178,
            "w": 143,
            "h": 19
        }
    },
    {
        "image": "gen3/IMG_1239.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 260,
            "y": 101,
            "w": 28,
            "h": 92
        }
    },
    {
        "image": "gen3/IMG_1238.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 231,
            "y": 100,
            "w": 56,
            "h": 16
        }
    },
    {
        "image": "gen3/IMG_1244.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 16,
            "y": 181,
            "w": 93,
            "h": 11
        }
    },
    {
        "image": "gen3/IMG_1233.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 122,
            "y": 181,
            "w": 93,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_1232.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 251,
            "y": 183,
            "w": 105,
            "h": 11
        }
    },
    {
        "image": "gen3/IMG_7964.HEIC.jpg",
        "correctFloor": "Arts1.jpg",
        "rect": {
            "x": 50,
            "y": 44,
            "w": 69,
            "h": 29
        }
    },
    {
        "image": "gen3/IMG_1473.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 131,
            "y": 39,
            "w": 16,
            "h": 115
        }
    },
    {
        "image": "gen3/IMG_1249.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 215,
            "y": 194,
            "w": 36,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_1248.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 216,
            "y": 70,
            "w": 19,
            "h": 111
        }
    },
    {
        "image": "gen3/IMG_8025.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 159,
            "y": 53,
            "w": 21,
            "h": 51
        }
    },
    {
        "image": "gen3/IMG_7957.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 276,
            "y": 59,
            "w": 52,
            "h": 108
        }
    },
    {
        "image": "gen3/IMG_7956.HEIC.jpg",
        "correctFloor": "Arts1.jpg",
        "rect": {
            "x": 58,
            "y": 63,
            "w": 70,
            "h": 198
        }
    },
    {
        "image": "gen3/IMG_7969.HEIC.jpg",
        "correctFloor": "CentralG.jpg",
        "rect": {
            "x": 157,
            "y": 156,
            "w": 82,
            "h": 60
        }
    },
    {
        "image": "gen3/IMG_7968.HEIC.jpg",
        "correctFloor": "CentralG.jpg",
        "rect": {
            "x": 228,
            "y": 65,
            "w": 161,
            "h": 83
        }
    },
    {
        "image": "gen3/IMG_7914.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 23,
            "y": 72,
            "w": 18,
            "h": 35
        }
    },
    {
        "image": "gen3/IMG_7915.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 113,
            "y": 200,
            "w": 37,
            "h": 36
        }
    },
    {
        "image": "gen3/IMG_1479.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 76,
            "y": 37,
            "w": 183,
            "h": 147
        }
    },
    {
        "image": "gen3/IMG_1478.HEIC.jpg",
        "correÃ¥ctFloor": "Arts4.jpg",
        "rect": {
            "x": 255,
            "y": 67,
            "w": 17,
            "h": 168
        }
    },
    {
        "image": "gen3/IMG_1234.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 123,
            "y": 107,
            "w": 48,
            "h": 78
        }
    },
    {
        "image": "gen3/IMG_7963.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 71,
            "y": 37,
            "w": 78,
            "h": 32
        }
    },
    {
        "image": "gen3/IMG_7962.HEIC.jpg",
        "correctFloor": "Arts2.jpg",
        "rect": {
            "x": 57,
            "y": 35,
            "w": 74,
            "h": 30
        }
    },
    {
        "image": "gen3/IMG_1446.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 281,
            "y": 181,
            "w": 30,
            "h": 45
        }
    },
    {
        "image": "gen3/IMG_7909.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 205,
            "y": 191,
            "w": 36,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_1464.HEIC.jpg",
        "correctFloor": "ArtsG.jpg",
        "rect": {
            "x": 93,
            "y": 76,
            "w": 112,
            "h": 183
        }
    },
    {
        "image": "output/FifthLCenter.heic.jpg",
        "correctFloor": "Arts5.jpg",
        "rect": {
            "x": 254,
            "y": 66,
            "w": 17,
            "h": 194
        }
    },
    {
        "image": "output/FifthFCenter.heic.jpg",
        "correctFloor": "Arts5.jpg",
        "rect": {
            "x": 96,
            "y": 67,
            "w": 50,
            "h": 193
        }
    },
    {
        "image": "gen3/IMG_1465.HEIC.jpg",
        "correctFloor": "ArtsG.jpg",
        "rect": {
            "x": 109,
            "y": 162,
            "w": 92,
            "h": 96
        }
    },
    {
        "image": "gen3/IMG_1481.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 128,
            "y": 38,
            "w": 20,
            "h": 183
        }
    },
    {
        "image": "gen3/IMG_1480.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 93,
            "y": 113,
            "w": 54,
            "h": 149
        }
    },
    {
        "image": "gen3/IMG_1229.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 123,
            "y": 100,
            "w": 91,
            "h": 16
        }
    },
    {
        "image": "gen3/IMG_1228.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 225,
            "y": 106,
            "w": 114,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_1260.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 22,
            "y": 194,
            "w": 30,
            "h": 38
        }
    },
    {
        "image": "gen3/IMG_1254.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 24,
            "y": 182,
            "w": 93,
            "h": 16
        }
    },
    {
        "image": "gen3/IMG_1255.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 24,
            "y": 195,
            "w": 28,
            "h": 32
        }
    },
    {
        "image": "gen3/IMG_1450.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 212,
            "y": 195,
            "w": 38,
            "h": 32
        }
    },
    {
        "image": "gen3/IMG_1451.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 237,
            "y": 107,
            "w": 56,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_7974.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 209,
            "y": 68,
            "w": 30,
            "h": 102
        }
    },
    {
        "image": "gen3/IMG_7975.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 150,
            "y": 160,
            "w": 104,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_7959.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 275,
            "y": 97,
            "w": 54,
            "h": 36
        }
    },
    {
        "image": "gen3/IMG_7958.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 276,
            "y": 60,
            "w": 55,
            "h": 110
        }
    },
    {
        "image": "gen3/IMG_1247.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 16,
            "y": 179,
            "w": 93,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_7910.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 14,
            "y": 69,
            "w": 29,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_7911.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 107,
            "y": 192,
            "w": 36,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_1230.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 237,
            "y": 107,
            "w": 58,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_1231.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 225,
            "y": 107,
            "w": 13,
            "h": 86
        }
    },
    {
        "image": "gen3/IMG_7967.HEIC.jpg",
        "correctFloor": "CentralG.jpg",
        "rect": {
            "x": 239,
            "y": 162,
            "w": 151,
            "h": 74
        }
    },
    {
        "image": "gen3/IMG_1477.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 130,
            "y": 177,
            "w": 126,
            "h": 19
        }
    },
    {
        "image": "gen3/IMG_1476.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 254,
            "y": 38,
            "w": 18,
            "h": 140
        }
    },
    {
        "image": "gen3/IMG_7953.HEIC.jpg",
        "correctFloor": "Arts1.jpg",
        "rect": {
            "x": 230,
            "y": 199,
            "w": 64,
            "h": 58
        }
    },
    {
        "image": "gen3/IMG_1449.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 122,
            "y": 192,
            "w": 28,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_1448.HEIC.jpg",
        "correctFloor": "SecondaryF.jpg",
        "rect": {
            "x": 124,
            "y": 148,
            "w": 47,
            "h": 36
        }
    },
    {
        "image": "gen3/IMG_1492.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 225,
            "y": 103,
            "w": 14,
            "h": 59
        }
    },
    {
        "image": "gen3/IMG_1493.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 160,
            "y": 96,
            "w": 55,
            "h": 10
        }
    },
    {
        "image": "gen3/IMG_1250.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 168,
            "y": 103,
            "w": 28,
            "h": 90
        }
    },
    {
        "image": "gen3/IMG_1251.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 142,
            "y": 184,
            "w": 96,
            "h": 11
        }
    },
    {
        "image": "gen3/IMG_1454.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 261,
            "y": 179,
            "w": 101,
            "h": 14
        }
    },
    {
        "image": "gen3/IMG_1455.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 206,
            "y": 192,
            "w": 35,
            "h": 33
        }
    },
    {
        "image": "gen3/IMG_7970.HEIC.jpg",
        "correctFloor": "Central1.jpg",
        "rect": {
            "x": 34,
            "y": 68,
            "w": 139,
            "h": 95
        }
    },
    {
        "image": "gen3/IMG_7971.HEIC.jpg",
        "correctFloor": "Central1.jpg",
        "rect": {
            "x": 173,
            "y": 159,
            "w": 42,
            "h": 43
        }
    },
    {
        "image": "gen3/IMG_1227.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 221,
            "y": 72,
            "w": 20,
            "h": 113
        }
    },
    {
        "image": "gen3/IMG_1226.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 222,
            "y": 70,
            "w": 25,
            "h": 117
        }
    },
    {
        "image": "gen3/IMG_1485.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 221,
            "y": 126,
            "w": 115,
            "h": 134
        }
    },
    {
        "image": "gen3/IMG_1484.HEIC.jpg",
        "correctFloor": "Arts6.jpg",
        "rect": {
            "x": 271,
            "y": 205,
            "w": 59,
            "h": 56
        }
    },
    {
        "image": "gen3/IMG_1257.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 105,
            "y": 79,
            "w": 46,
            "h": 30
        }
    },
    {
        "image": "gen3/IMG_1256.HEIC.jpg",
        "correctFloor": "SecondaryL.jpg",
        "rect": {
            "x": 50,
            "y": 183,
            "w": 191,
            "h": 13
        }
    },
    {
        "image": "gen3/IMG_1453.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 15,
            "y": 179,
            "w": 130,
            "h": 16
        }
    },
    {
        "image": "gen3/IMG_1452.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 130,
            "y": 148,
            "w": 32,
            "h": 34
        }
    },
    {
        "image": "gen3/IMG_1488.HEIC.jpg",
        "correctFloor": "Central1.jpg",
        "rect": {
            "x": 237,
            "y": 147,
            "w": 34,
            "h": 15
        }
    },
    {
        "image": "gen3/IMG_1489.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 14,
            "y": 159,
            "w": 148,
            "h": 17
        }
    },
    {
        "image": "gen3/IMG_1467.HEIC.jpg",
        "correctFloor": "ArtsG.jpg",
        "rect": {
            "x": 300,
            "y": 12,
            "w": 72,
            "h": 53
        }
    },
    {
        "image": "gen3/IMG_1466.HEIC.jpg",
        "correctFloor": "ArtsG.jpg",
        "rect": {
            "x": 196,
            "y": 74,
            "w": 122,
            "h": 112
        }
    },
    {
        "image": "gen3/IMG_1482.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 126,
            "y": 39,
            "w": 22,
            "h": 187
        }
    },
    {
        "image": "gen3/IMG_1483.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 256,
            "y": 196,
            "w": 69,
            "h": 43
        }
    },
    {
        "image": "gen3/IMG_1458.HEIC.jpg",
        "correctFloor": "SecondaryB.jpg",
        "rect": {
            "x": 91,
            "y": 76,
            "w": 67,
            "h": 125
        }
    },
    {
        "image": "gen3/IMG_1240.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 16,
            "y": 72,
            "w": 126,
            "h": 44
        }
    },
    {
        "image": "gen3/IMG_1241.HEIC.jpg",
        "correctFloor": "SecondaryG.jpg",
        "rect": {
            "x": 141,
            "y": 102,
            "w": 145,
            "h": 11
        }
    },
    {
        "image": "gen3/IMG_1237.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 223,
            "y": 71,
            "w": 27,
            "h": 37
        }
    },
    {
        "image": "gen3/IMG_1236.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 223,
            "y": 71,
            "w": 26,
            "h": 36
        }
    },
    {
        "image": "gen3/IMG_7960.HEIC.jpg",
        "correctFloor": "Arts4.jpg",
        "rect": {
            "x": 75,
            "y": 37,
            "w": 58,
            "h": 30
        }
    },
    {
        "image": "gen3/IMG_7961.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 73,
            "y": 37,
            "w": 62,
            "h": 30
        }
    },
    {
        "image": "gen3/IMG_1445.HEIC.jpg",
        "correctFloor": "SecondaryS.jpg",
        "rect": {
            "x": 280,
            "y": 181,
            "w": 32,
            "h": 47
        }
    },
    {
        "image": "gen3/IMG_1470.HEIC.jpg",
        "correctFloor": "Arts2.jpg",
        "rect": {
            "x": 110,
            "y": 178,
            "w": 200,
            "h": 20
        }
    },
    {
        "image": "gen3/IMG_1471.HEIC.jpg",
        "correctFloor": "Arts3.jpg",
        "rect": {
            "x": 129,
            "y": 66,
            "w": 17,
            "h": 170
        }
    },
    {
        "image": "gen3/IMG_7954.HEIC.jpg",
        "correctFloor": "Arts2.jpg",
        "rect": {
            "x": 236,
            "y": 196,
            "w": 62,
            "h": 38
        }
    },
    {
        "image": "gen3/IMG_7955.HEIC.jpg",
        "correctFloor": "Arts2.jpg",
        "rect": {
            "x": 111,
            "y": 177,
            "w": 128,
            "h": 20
        }
    },
    {
        "image": "gen3/IMG_8026.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 223,
            "y": 53,
            "w": 16,
            "h": 51
        }
    },
    {
        "image": "gen3/IMG_1491.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 89,
            "y": 159,
            "w": 24,
            "h": 12
        }
    },
    {
        "image": "gen3/IMG_7976.HEIC.jpg",
        "correctFloor": "Central2.jpg",
        "rect": {
            "x": 89,
            "y": 159,
            "w": 115,
            "h": 13
        }
    }
];
      
    
    const hotkeyMap = {
      "AG": "ArtsG.jpg",
      "A1": "Arts1.jpg",
      "A2": "Arts2.jpg",
      "A3": "Arts3.jpg",
      "A4": "Arts4.jpg",
      "A5": "Arts5.jpg",
      "A6": "Arts6.jpg",
      "CG": "CentralG.jpg",
      "C1": "Central1.jpg",
      "C2": "Central2.jpg",
      "SB": "SecondaryB.jpg",
      "SL": "SecondaryL.jpg",
      "SG": "SecondaryG.jpg",
      "SF": "SecondaryF.jpg",
      "SS": "SecondaryS.jpg",
    };

    let lastKey = "";

    document.addEventListener("keyup", (e) => {
      const key = e.key.toUpperCase();

      if (!/^[A-Z0-9]$/.test(key)) return; // Ignore non-alphanumeric keys

      const combo = lastKey + key;

      if (hotkeyMap[combo]) {
        floorplanImg.src = hotkeyMap[combo];
        floorSelect.value = hotkeyMap[combo];
        lastKey = ""; // Reset after valid combo
      } else {
        lastKey = key; // Store as potential first key
      }
    });

    let maxRounds = 5;
    let round = 0, score = 0, roundScore = 0;
    let currentLocation, pinX = null, pinY = null, timer = null, timeLeft = 0;
    let splits = [];

    const locationImg = document.getElementById('location-image');
    const floorplanImg = document.getElementById('floorplan-image');
    const floorSelect = document.getElementById('floor-select');
    const guessBtn = document.getElementById('guess-button');
    const pin = document.getElementById('pin');
    const timerDisplay = document.getElementById('timer-display');
    const scoreDisplay = document.getElementById('score-display');
    const startBtn = document.getElementById('start-game');
    const rounds = document.getElementById('rounds');
    const blink = document.getElementById('blink');
    var startTime;

    function hide() {
      document.getElementById("hider").hidden = false;
    }

    function callback() {
      const elapsed = performance.now() - startTime;
      const drift = elapsed - blink.value;
      
      console.log(drift);
      if (drift >= 0) {
        hide();
        return;
      }
      setTimeout(callback, 5);
    }

    function scheduleTimeout() {
      startTime = performance.now();
      timeoutId = setTimeout(callback, 5);
    }

    function startGame() {
      round = 0;
      score = 0;
      splits = [];
      maxRounds = parseInt(rounds.value);
      if (parseInt(blink.value) > 0) {
        hide = () => {
          document.getElementById("hider").hidden = false;
        };
      } else {
        hide = () => {};
      }
      document.getElementById('score-display').textContent = '';
      nextRound();
    }

    function setLocation() {
      let randIndex = Math.floor(Math.random() * locations.length);
      currentLocation = locations[randIndex];
    }

    function startTimer(duration) {
      timeLeft = duration;
      timerDisplay.textContent = `Time: ${timeLeft}`;
      timer = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = `Time: ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          endRound(true);
        }
      }, 1000);
    }

    function imageExists(image_url){

      var http = new XMLHttpRequest();

      http.open('HEAD', image_url, false);
      http.send();

      return http.status != 404;

    }

    function sum(x) {
      let ans = 0;
      for (i of x) ans += i;
      return ans;
    }

    async function nextRound() {
      if (round >= maxRounds) {
        let splitsStr = "";
        for (let i = 0; i < maxRounds-1; i++) {
          splitsStr += splits[i] + "s, ";
        }
        splitsStr += splits[maxRounds-1] + "s";
        scoreDisplay.innerHTML = `Game Over! Final Score: ${score}/${5000*maxRounds}<br>Splits: ${splitsStr}<br>Final Time: ${sum(splits)}s<br><button onclick="startGame()">Play Again</button>`;
        
        return;
      }
      document.getElementById("hider").hidden = false;
      round++;
      pin.style.display = 'none';
      pinX = pinY = null;
      setLocation();
      locationImg.onerror = setLocation;
      floorplanImg.src = "FloorPlan.jpg";
      floorSelect.value = "FloorPlan.jpg";
      guessBtn.disabled = false;
      locationImg.src = currentLocation.image;
      document.getElementById("hider").hidden = true;
      scheduleTimeout(parseInt(blink.value)+100);
      startTimer(parseInt(document.getElementById('timer-input').value));
    }

    document.getElementById('map-container').addEventListener('click', (e) => {
      const rect = e.currentTarget.getBoundingClientRect();
      pinX = e.clientX - rect.left;
      pinY = e.clientY - rect.top;
      pin.style.left = `${pinX}px`;
      pin.style.top = `${pinY}px`;
      pin.style.display = 'block';
    });

    guessBtn.addEventListener('click', () => endRound());
    addEventListener('keyup', (e) => {
      if (e.key === ' ') {
        if (!guessBtn.disabled) endRound();
      }
    });



    function endRound(timerExpired = false) {
      clearInterval(timer);
      splits.push(parseInt(document.getElementById('timer-input').value)-timeLeft);
      let roundPoints = 0;
      const floorChosen = floorSelect.value;
      const rect = currentLocation.rect;
      if (timerExpired && (pinX === null || pinY === null)) {
        roundPoints = 0;
      } else if (
        pinX >= rect.x &&
        pinX <= rect.x + rect.w &&
        pinY >= rect.y &&
        pinY <= rect.y + rect.h &&
        floorChosen === currentLocation.correctFloor
      ) {
        roundPoints = 5000;
      } else if (floorChosen === currentLocation.correctFloor && pinX !== null && pinY !== null) {
        const dx = Math.max(rect.x - pinX, 0, pinX - (rect.x + rect.w));
        const dy = Math.max(rect.y - pinY, 0, pinY - (rect.y + rect.h));
        const D = Math.sqrt(dx * dx + dy * dy);
        roundPoints = Math.round(5000 * Math.exp(-D / 150));
      }
      score += roundPoints;
      scoreDisplay.innerHTML = `Round ${round} Score: ${roundPoints}/5000<br>Correct Floor: ${currentLocation.correctFloor}<br>Total Score: ${score}`;
      setTimeout(nextRound, 2000);
      guessBtn.disabled = true;

      const correctBox = document.createElement('div');
      correctBox.style.position = 'absolute';
      correctBox.style.left = `${rect.x}px`;
      correctBox.style.top = `${rect.y}px`;
      correctBox.style.width = `${rect.w}px`;
      correctBox.style.height = `${rect.h}px`;
      correctBox.style.backgroundColor = 'rgba(255, 0, 0, 0.6)';
      correctBox.style.border = '2px solid red';
      correctBox.style.zIndex = 2;

      // Remove any previous box
      const oldBox = document.getElementById('correct-box');
      if (oldBox) oldBox.remove();
      correctBox.id = 'correct-box';
      document.getElementById('map-container').appendChild(correctBox);
      floorplanImg.src = currentLocation.correctFloor;

      // Auto remove box after 2 seconds
      setTimeout(() => {
        const box = document.getElementById('correct-box');
        if (box) box.remove();
      }, 2000);
    }

    function updateFloor() {
        floorSelect.value;
        floorplanImg.src = floorSelect.value;
    }

    startBtn.addEventListener('click', startGame);
  </script>
</body>
</html>